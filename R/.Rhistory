plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
genes <- c("YKL081W", "YAL003W", "YDL175C")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
genes <- c("YKL081W", "YAL003W", "YPL048W")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
genes <- c("YKL081W", "YAL003W", "YOL115W")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
genes <- c("YKL081W", "YAL003W")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
genes <- c("YKL081W", "YAL003W")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 3, col = "red")
})
genes <- c("YKL081W", "YAL003W")
geneSubset <- subset(resLFC, symbol %in% genes)
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
?text
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, offset = 1, col = "red")
})
## MA Plot
plotMA(resLFC, alpha = 0.05, ylim=c(-5,15), cex=.8)
abline(h=c(-1,1), col="dodgerblue", lwd=2)
with(geneSubset, {
points(baseMean, log2FoldChange, col = "red", cex = 2, lwd = 2)
text(baseMean, log2FoldChange, geneSubset$symbol, pos = 1, col = "red")
})
# Heatmap
select <- order(rowMeans(counts(dds,normalized=TRUE)),
decreasing=TRUE)[1:20]
df <- as.data.frame(colData(dds)[,c("condition","genotype")])
mat <- assay(vsd)[select,]
rownames(df) <- colnames(mat)
pheatmap(mat, cluster_rows=FALSE, show_rownames=TRUE,
cluster_cols=FALSE, annotation_col=df)
BiocManager::install("GenomicRanges")
BiocManager::install("BSgenome.Hsapiens.NCBI.GRCh38")
knitr::opts_chunk$set(echo = TRUE)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety")]),]
model <- lm(anxiety ~ depression, data=subset)
summary(model)
model <- lm(anxiety ~ depression, data=subset)
anova(model)
knitr::opts_chunk$set(echo = TRUE)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety","chrnpain","age")]),]
# subset$depression_centered <-
mean(subset$depression)
subset$depression_centered <- subset$depression - 2.5
median(subset$depression_centered)
mean(subset$depression_centered)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety","chrnpain","age")]),]
subset$depression_c <- subset$depression - 2.5
subset$age_c <- subset$age - 63
View(subset)
View(subset)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety","chrnpain","age")]),]
subset$depression_c <- subset$depression - 2.5
subset$age_c <- subset$age - 63
model1 <- lm(anxiety ~ depression + chrnpain + age, data=subset)
summary(model1)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety","chrnpain","age")]),]
subset$depression_c <- subset$depression - 2.5
subset$age_c <- subset$age - 63
model1 <- lm(anxiety ~ depression_c + chrnpain + age_c, data=subset)
summary(model1)
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1)) - predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
2.894004 - 2.938689
predict.lm(model1, data.frame(depression_c=2.5, age_c=-3, chrnpain=1))
predict.lm(model1, data.frame(depression_c=2.5, age_c=-3, chrnpain=0))
2.894004 - 2.938689
predict_1c_chrnpain <- predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict_1c_nochrnpain <-predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict_1c_chrnpain - predict_1c_nochrnpain
predict_1c_chrnpain <- predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict_1c_chrnpain
predict_1c_nochrnpain <-predict.lm(model1, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict_1c_nochrnpain
predict_1c_chrnpain - predict_1c_nochrnpain
predict_eq_chrnpain <- predict.lm(model1, data.frame(depression_c=2.5, age_c=-3, chrnpain=1))
predict_eq_chrnpain
predict_eq_nochrnpain <- predict.lm(model1, data.frame(depression_c=2.5, age_c=-3, chrnpain=0))
predict_eq_nochrnpain
predict_eq_chrnpain - predict_eq_nochrnpain
model2 <- lm(anxiety ~ depression_c + chrnpain + age_c, depression_c*chrnpain, data=subset)
model2 <- lm(anxiety ~ depression_c + chrnpain + age_c + depression_c*chrnpain, data=subset)
summary(model2)
summary(model2)
predict_1h_chrnpain <- predict.lm(model2, data.frame(depression_c=0, age_c=-3, chrnpain=1))
predict_1h_chrnpain
predict_1h_nochrnpain <-predict.lm(model2, data.frame(depression_c=0, age_c=-3, chrnpain=0))
predict_1h_nochrnpain
predict_1h_chrnpain - predict_1h_nochrnpain
predict_eq2_chrnpain <- predict.lm(model2, data.frame(depression_c=2.5, age_c=-3, chrnpain=1))
predict_eq2_chrnpain
predict_eq2_nochrnpain <- predict.lm(model2, data.frame(depression_c=2.5, age_c=-3, chrnpain=0))
predict_eq2_nochrnpain
predict_eq2_chrnpain - predict_eq2_nochrnpain
knitr::opts_chunk$set(echo = TRUE)
surgery <- read.csv("surgery.txt", header=TRUE, row.names="idn")
subset <- surgery[complete.cases(surgery[,cbind("depression","anxiety","pain","age","chrnpain")]),]
View(subset)
model1 <- lm(pain ~ depression + age, data=subset)
model2 <- lm(pain ~ depression + age + chrnpain, data=subset)
summary(model1)
summary(model2)
model1 <- lm(pain ~ depression + age, data=subset)
summary(model1)
model2 <- lm(pain ~ depression + age + chrnpain, data=subset)
summary(model2)
summary(model2)$depression
?summary
summary(model2)$coefficients
summary(model2)$coefficients["depression"]
summary(model2)$coefficients["depression",]
summary(model2)$coefficients["depression","estimate"]
summary(model2)$coefficients["depression","Estimate"]
model1 <- lm(pain ~ depression + age, data=subset)
summary(model1)
model2 <- lm(pain ~ depression + age + chrnpain, data=subset)
summary(model2)
(summary(model2)$coefficients["depression","Estimate"] - summary(model1)$coefficients["depression","Estimate"]) / summary(model2)$coefficients["depression","Std. Error"]
model1 <- lm(pain ~ depression + age, data=subset)
summary(model1)
model2 <- lm(pain ~ depression + age + chrnpain, data=subset)
summary(model2)
(summary(model1)$coefficients["depression","Estimate"] - summary(model2)$coefficients["depression","Estimate"]) / summary(model2)$coefficients["depression","Std. Error"]
summary(model3)
model3 <- lm(chrnpain ~ depression + age, data=subset)
summary(model3)
knitr::opts_chunk$set(echo = TRUE)
cancer <- c("case","case","control","control")
alcohol <- c("high","low","high","low")
oeso <- as.data.frame(cbind(cancer,alcohol))
n.times <- c(104, 96, 666, 109)
oeso <- oeso[rep(seq_len(nrow(oeso)),n.times),]
View(oeso)
View(oeso)
library(vcdExtra)
install.packages("vcdExtra")
knitr::opts_chunk$set(echo = TRUE)
library(vcdExtra)
CMHtest(oeso)
CMHtest(matrix(oeso))
View(oeso)
table <- matrix(n.times, 2, 2)
View(table)
table <- matrix(n.times, 2, 2, byrow = False)
table <- matrix(n.times, 2, 2, byrow = false)
table <- matrix(n.times, 2, 2, byrow = FALSE)
View(table)
table <- matrix(n.times, 2, 2, byrow = FALSE)
table <- matrix(n.times, 2, 2, byrow = TRUE)
View(table)
#CMHtest(
```
CMHtest(table)
table[0,1]
table[0][1]
table
table[1,1]
oddsratio(table)
fsmb::oddsratio(table)
library(epitools)
install.packages("epitools")
library(epitools)
knitr::opts_chunk$set(echo = TRUE)
library(vcdExtra)
library(epitools)
table <- matrix(n.times, 2, 2, byrow = TRUE)
CMHtest(table)
OR = epitools::oddsratio(table)
table <- matrix(n.times, 2, 2, byrow = TRUE)
CMHtest(table)
epitools::oddsratio(table)
table <- matrix(n.times, 2, 2, byrow = TRUE)
CMHtest(table)
epitools::oddsratio(table)
epitools::oddsratio.wald(table)
epitools::oddsratio.wald(table)
oddsratio(table)
oddsratio.wald(table)
oddsratio.wald(table)
table2 <- matrix(c(27,44,95,443), 2, 2, byrow = TRUE)
View(table2)
table2 <- matrix(c(27,44,95,443), 2, 2, byrow = TRUE)
chisq.test(table2, correct = FALSE)
chisq.test(table2, correct = TRUE)
CMHtest(table2)
table2 <- matrix(c(27,44,95,443), 2, 2, byrow = TRUE)
chisq.test(table2, correct = FALSE)
chisq.test(table2, correct = TRUE)
CMHtest(table2)
chisq.test(table)
chisq.test(table, correct = FALSE)
knitr::opts_chunk$set(echo = TRUE)
install.packages("DescTools")
install.packages("purrr")
install.packages("dplyr")
install.packages("magrittr")
install.packages("epitools")
install.packages("fmsb")
install.packages("gmodels")
install.packages("vcdExtra")
install.packages("lmtest")
install.packages("car")
install.packages("epiDisplay")
install.packages("lawstat")
library(DescTools)
library(purrr)
library(dplyr)
library(magrittr)
library(epitools)
library(fmsb)
library(gmodels)
require(lmtest)
library(car)
library(vcdExtra)
library(epiDisplay)
library(lawstat)
knitr::opts_chunk$set(echo = TRUE)
install.packages("DescTools")
install.packages("purrr")
install.packages("dplyr")
install.packages("magrittr")
install.packages("epitools")
install.packages("fmsb")
install.packages("gmodels")
install.packages("vcdExtra")
install.packages("lmtest")
install.packages("car")
install.packages("epiDisplay")
install.packages("lawstat")
library(DescTools)
library(purrr)
library(dplyr)
library(magrittr)
library(epitools)
library(fmsb)
library(gmodels)
require(lmtest)
library(car)
library(vcdExtra)
library(epiDisplay)
library(lawstat)
install.packages("epiDisplay")
knitr::opts_chunk$set(echo = TRUE)
install.packages("DescTools")
install.packages("purrr")
install.packages("dplyr")
install.packages("magrittr")
install.packages("epitools")
install.packages("fmsb")
install.packages("gmodels")
install.packages("vcdExtra")
install.packages("fmsb")
install.packages("lmtest")
install.packages("car")
install.packages("epiDisplay")
install.packages("lawstat")
knitr::opts_chunk$set(echo = TRUE)
library(DescTools)
library(purrr)
library(dplyr)
library(magrittr)
library(epitools)
library(fmsb)
library(gmodels)
require(lmtest)
library(car)
library(vcdExtra)
library(epiDisplay)
library(lawstat)
oesophageal = read.csv("oesophageal.csv", header = TRUE)
View(oesophageal)
View(oesophageal)
oesophageal = read.csv("oesophageal.csv", header = TRUE)
agegrp4_5 <- oesophageal %>% filter(agegrp==4 | agegrp==5)
agegrp4_5$tobacco_gt_2 = agegrp4_5$tobacco>2
View(agegrp4_5)
oesophageal = read.csv("oesophageal.csv", header = TRUE)
agegrp4_5 <- oesophageal %>% filter(agegrp==4 | agegrp==5)
agegrp4_5$tobacco_gt_2 = agegrp4_5$tobacco>2
table <- xtabs(~case+tobacco_gt_2,data=agegrp4_5)[,2:1]
table
oesophageal = read.csv("oesophageal.csv", header = TRUE)
agegrp4_5 <- oesophageal %>% filter(agegrp==4 | agegrp==5)
agegrp4_5$tobacco_gt_2 = agegrp4_5$tobacco>2
table <- xtabs(~case+tobacco_gt_2,data=agegrp4_5)[,2:1]
oddsratio.wald(table)
oesophageal = read.csv("oesophageal.csv", header = TRUE)
agegrp4_5 <- oesophageal %>% filter(agegrp==4 | agegrp==5)
agegrp4_5$tobacco_gt_2 = agegrp4_5$tobacco>2
table1 <- xtabs(~case+tobacco_gt_2,data=agegrp4_5)[,2:1]
oddsratio.wald(table1)
?oddsratio.wald
agegrp4 <- agegrp4_5 %>% filter(agegrp==4)
agegrp5 <- agegrp4_5 %>% filter(agegrp==5)
table2 <- xtabs(~case+tobacco_gt_2,data=agegrp4)[,2:1]
table3 <- xtabs(~case+tobacco_gt_2,data=agegrp5)[,2:1]
View(agegrp4)
View(agegrp5)
tabl2
table2
table3
agegrp4 <- agegrp4_5 %>% filter(agegrp==4)
agegrp5 <- agegrp4_5 %>% filter(agegrp==5)
table2 <- xtabs(~case+tobacco_gt_2,data=agegrp4)[,2:1]
table3 <- xtabs(~case+tobacco_gt_2,data=agegrp5)[,2:1]
oddsratio.wald(table2)
oddsratio.wald(table3)
table
table2
age_adj_array <- array(c(table2, table3), dim=c(2,2,2))
age_adj_array
cmh.test(age_adj_array)
mantelhaen.test(age_adj_array)
?mantelhaen.test
?cmh.test
age_adj_array <- array(c(table2, table3), dim=c(2,2,2))
mantelhaen.test(age_adj_array)
table
table1
table2
table3
?mantelhaen.test
test <- mantelhaen.test(age_adj_array)
test
test$estimate
test$null.value
table2
table3
knitr::opts_chunk$set(echo = TRUE)
library(DescTools)
library(purrr)
library(dplyr)
library(tidyr)
library(magrittr)
library(epitools)
library(fmsb)
library(gmodels)
require(lmtest)
library(car)
library(vcdExtra)
library(epiDisplay)
library(lawstat)
knitr::opts_chunk$set(echo = TRUE)
library(DescTools)
library(purrr)
library(dplyr)
library(tidyr)
library(magrittr)
library(epitools)
library(fmsb)
library(gmodels)
require(lmtest)
library(car)
library(vcdExtra)
library(epiDisplay)
library(lawstat)
library(multcomp)
?waldtest
knitr::opts_chunk$set(echo = TRUE)
hotflash <- c("yes","yes","no","no")
vitC <- c("yes","no","yes","no")
df <- as.data.frame(cbind(cancer,alcohol))
hotflash <- c("yes","yes","no","no")
vitC <- c("yes","no","yes","no")
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
table
View(df)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
View(df)
View(df)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
glm(hotflash ~ vitC, family = "binomial", data = df)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash ~ vitC, family = "binomial", data = df)
summary(model)
table
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash, family = "binomial", data = df)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash ~ 1, family = "binomial", data = df)
summary(model)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash ~ 1, data = df)
summary(model)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash ~ 1, family = "binomial", data = df)
summary(model)
hotflash <- c(1,1,0,0)
vitC <- c(1,0,1,0)
df <- as.data.frame(cbind(hotflash,vitC))
n.times <- c(84, 30, 122, 278)
df <- df[rep(seq_len(nrow(df)),n.times),]
table <- xtabs(~hotflash+vitC,data=df)[,2:1]
model <- glm(hotflash ~ vitC, family = "binomial", data = df)
summary(model)
install.packages(c("usethis", "devtools", "roxygen2"))
install.packages(c("usethis", "devtools", "roxygen2"))
install.packages("here")
here::here()
library(devtools)
library(roxygen2)
library(devtools)
git
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
foxa1 <- readRDS("../MA0148.1.Rds")
foxa1 <- readRDS("../data/MA0148.1.Rds")
foxa1
foxa1@matrix
foxa1@pwm_filename
foxa1@baseline
foxa1@tf_name
foxa1@matrix
